<!doctype html>
<html lang="en">
<head>
  <!-- Ads (async; harmless if blocked) -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6216304334889617" crossorigin="anonymous"></script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Domain Finder (Available + Expiring) | UpTools</title>
  <meta name="description" content="Find ONLY real opportunities: domains AVAILABLE now or EXPIRING soon (with expiry dates). Use Seed Keyword Finder, Length-Based Generator, or Regex Filter. RDAP checks + optional traffic. Export CSV." />
  <meta name="keywords" content="domain finder, available domains, expiring domains, RDAP, regex domain search, length based domains, pronounceable domains, domain flipping, brandable names" />
  <meta name="robots" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:-1" />
  <meta name="theme-color" content="#0b1020" />
  <link rel="canonical" href="https://www.uptools.in/domain-finder/" />

  <!-- Icons -->
  <link rel="icon" type="image/svg+xml" href="/assets/logo/uptools-logo.svg" />
  <link rel="apple-touch-icon" href="/assets/logo/uptools-logo.svg" />

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Domain Finder (Available + Expiring) | UpTools" />
  <meta property="og:description" content="Seed, Length, or Regex based discovery. Shows ONLY available or expiring domains (with dates). Optional traffic. Export CSV." />
  <meta property="og:url" content="https://www.uptools.in/domain-finder/" />
  <meta property="og:image" content="/assets/og/domain-finder.png" />
  <meta property="og:site_name" content="UpTools" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Domain Finder (Available + Expiring)" />
  <meta name="twitter:description" content="Generate or filter domains via Seed, Length, or Regex. Only AVAILABLE & EXPIRING (with dates)." />
  <meta name="twitter:image" content="/assets/og/domain-finder.png" />

  <!-- Common CSS & Utils -->
  <link rel="stylesheet" href="/style.css?v=1.3.6" />
  <script src="/scripts/utils.js" type="module"></script>

  <!-- JSON-LD -->
  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@graph":[
      {
        "@type":"SoftwareApplication",
        "name":"UpTools Domain Finder",
        "applicationCategory":"BusinessApplication",
        "operatingSystem":"Any",
        "url":"https://www.uptools.in/domain-finder/",
        "image":"https://www.uptools.in/assets/og/domain-finder.png",
        "description":"Find AVAILABLE domains and EXPIRING soon domains with expiry dates. Seed keywords, Length-based, or Regex filter.",
        "offers":{"@type":"Offer","price":"0","priceCurrency":"INR"}
      },
      {
        "@type":"BreadcrumbList",
        "itemListElement":[
          {"@type":"ListItem","position":1,"name":"Home","item":"https://www.uptools.in/"},
          {"@type":"ListItem","position":2,"name":"Tools","item":"https://www.uptools.in/#tools"},
          {"@type":"ListItem","position":3,"name":"Domain Finder","item":"https://www.uptools.in/domain-finder/"}
        ]
      }
    ]
  }
  </script>

  <style>
    /* ---------- Base ---------- */
    *,*::before,*::after{ box-sizing:border-box; }
    html,body{ height:100%; }
    img{ max-width:100%; height:auto; }
    :root{ --header-h:60px; --content-w:1120px; --radius:12px; }
    body{
      background:
        radial-gradient(900px 480px at 12% -10%, #0b1020 0, transparent 50%),
        linear-gradient(135deg,#0a0f1a,#0a1220);
    }

    /* ---------- Header ---------- */
    .site{ position:sticky; top:0; z-index:20; background:rgba(8,12,20,.6); backdrop-filter:blur(6px); border-bottom:1px solid rgba(255,255,255,.06);}
    .header-inner{ max-width:var(--content-w); margin:0 auto; padding:.6rem .8rem; display:flex; justify-content:space-between; align-items:center; min-height:var(--header-h); }
    .brand{ display:flex; gap:.5rem; align-items:center; color:#eaf3ff; text-decoration:none; }
    .nav-links a{ color:#b8c7d9; margin-left:1rem; text-decoration:none; }
    .nav-links a[aria-current="page"]{ color:#fff; font-weight:700; text-decoration:underline; text-underline-offset:6px; }

    /* ---------- Layout ---------- */
    main.page{
      max-width:var(--content-w);
      margin:0 auto;
      padding:.75rem;
      height:calc(100dvh - var(--header-h));
      display:grid;
      grid-template-columns: 420px 1fr;
      gap:.75rem;
      min-height:560px;
    }
    @media (max-width: 1020px){ main.page{ grid-template-columns:1fr; height:auto; } }

    /* ---------- Panels ---------- */
    .panel,.card{ background:#0f1726; border:1px solid rgba(255,255,255,.08); border-radius:var(--radius); box-shadow:0 10px 30px rgba(0,0,0,.35); }
    .panel{ display:flex; flex-direction:column; min-height:0; }
    .panel-header{ padding:.8rem .9rem; border-bottom:1px solid rgba(255,255,255,.08); display:flex; align-items:center; justify-content:space-between; }
    .panel-title{ display:flex; align-items:center; gap:.5rem; font-weight:800; color:#e9f2ff; }
    .pill{ display:inline-block; padding:.32rem .6rem; border-radius:10px; background:linear-gradient(135deg,#64ffda,#41c9a8); color:#07161a; font-weight:900; line-height:1; white-space:nowrap; }
    .panel-body{ padding:.8rem .9rem; display:grid; gap:.75rem; overflow:auto; max-height:calc(100% - 54px); }
    .section{ border:1px dashed #263248; border-radius:12px; padding:.75rem; display:grid; gap:.6rem; }
    .section h4{ margin:0; color:#eaf3ff; display:flex; align-items:center; gap:.5rem; font-size:1.02rem; }

    .row-grid{ display:grid; gap:.6rem; }
    .row-2{ grid-template-columns:1fr 1fr; gap:.6rem; }
    .row-3{ grid-template-columns:repeat(3,1fr); gap:.6rem; }
    @media (max-width:950px){ .row-2,.row-3{ grid-template-columns:1fr; } }

    /* Inputs & chips */
    label{ color:#c7d6e5; font-size:.95rem; }
    .input,.textarea,select{ background:#0b1322; border:1px solid #263248; color:#e7f0ff; border-radius:10px; padding:.6rem .75rem; outline:none; width:100%; }
    .textarea{ min-height:120px; resize:vertical; }
    .chips{ display:flex; flex-wrap:wrap; gap:.5rem; }
    .chip{ padding:.45rem .7rem; border-radius:999px; background:#0b1322; border:1px solid #263248; color:#a9bed4; cursor:pointer; user-select:none; transition:.15s; position:relative; font-weight:600; }
    .chip.active{ background:linear-gradient(135deg,rgba(100,255,218,.20),rgba(65,201,168,.20)); border-color:#4bdcb3; color:#eafffb; outline:2px solid rgba(100,255,218,.25); outline-offset:1px; box-shadow:0 0 0 2px rgba(75,220,179,.1) inset; }

    .btn{ border:1px solid #2a3a57; background:#122034; color:#d8e7ff; border-radius:10px; padding:.55rem .9rem; font-weight:700; cursor:pointer; }
    .btn.primary{ background:linear-gradient(180deg,#13aa87,#0e8c71); border-color:#0b6b57; }
    .btn.secondary{ background:#10182a; }
    .btn.ghost{ background:transparent; }
    .btn.sm{ padding:.35rem .6rem; font-size:.85rem; white-space:nowrap; }

    .kbar{ display:flex; align-items:center; gap:.6rem; font-size:.9rem; color:#9db2c8; }
    .progress{ height:8px; background:#0b1326; border:1px solid #203052; border-radius:8px; width:100%; overflow:hidden; }
    .progress>span{ display:block; height:100%; width:0%; background:linear-gradient(90deg,#64ffda,#41c9a8); transition:width .25s ease; }

    /* RIGHT area */
    .right{ display:grid; grid-template-rows:min-content minmax(0,1fr); gap:.75rem; min-height:0; }
    .lists{ display:grid; grid-template-columns:1fr 1fr; gap:.75rem; min-height:0; }
    @media (max-width:950px){ .lists{ grid-template-columns:1fr; } }
    .card h3{ margin:.8rem .9rem; overflow: auto; display:flex; align-items:center; justify-content:space-between; }
    .rows{ display:grid; gap:.5rem; overflow:auto; padding:0 .9rem .9rem; max-height:calc(100% - 48px); }

    .rowi{ display:grid; grid-template-columns:1fr auto; gap:.6rem; align-items:center; border:1px dashed #253149; border-radius:10px; padding:.7rem .8rem; background:#0b1326; overflow:hidden; }
    .n{ font-weight:800; color:#dffaf2; overflow-wrap:anywhere; word-break:break-word; }
    .meta{ display:flex; flex-wrap:wrap; gap:.45rem; margin-top:.35rem; font-size:.85rem; }
    .tag{ border:1px solid #2a3a57; background:#0a1224; color:#b9d0ff; padding:.25rem .55rem; border-radius:999px; }
    .score{ color:#aef8e4; font-weight:800; }
    .when{ color:#ffd3a3; font-weight:800; }
    .rank{ color:#cfa9ff; font-weight:800; }
    .visits{ color:#8ff9ff; font-weight:800; }
    .badge{ font:700 12px/1 system-ui; border:1px solid #203052; background:#0b1326; color:#cfe7ff; padding:.25rem .55rem; border-radius:999px; }

    /* Regex examples */
    .examples{ display:flex; flex-wrap:wrap; gap:.4rem; }
    .ex{ font:600 .9rem/1.2 system-ui; color:#cfe7ff; background:#0b1326; border:1px solid #203052; border-radius:8px; padding:.28rem .5rem; }

    /* Video */
    .video-card .frame{ position:relative; width:100%; aspect-ratio:16/9; border-top:1px solid rgba(255,255,255,.06); border-bottom-left-radius:var(--radius); border-bottom-right-radius:var(--radius); overflow:hidden; background:#0b1326; }
    .video-card iframe{ position:absolute; inset:0; width:100%; height:100%; border:0; }
    .thumb{ position:absolute; inset:0; cursor:pointer; display:grid; place-items:center; }
    .thumb img{ width:100%; height:100%; object-fit:cover; }
    .thumb .play{ position:absolute; width:72px; height:72px; border-radius:999px; background:rgba(0,0,0,.5); border:2px solid #fff; display:grid; place-items:center; }
    .thumb .play::after{ content:""; border-left:18px solid #fff; border-top:10px solid transparent; border-bottom:10px solid transparent; margin-left:6px; }

    footer{ max-width:var(--content-w); margin:.6rem auto 1rem; color:#9db3c6; text-align:center; }
    footer a{ color:#9ac7ff; text-decoration:none; }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="site" role="banner">
    <div class="header-inner">
      <a class="brand" href="/" aria-label="UpTools Home">
        <img src="/assets/logo/uptools-logo.svg" alt="UpTools logo" width="28" height="28" loading="eager">
        <b>UpTools</b>
      </a>
      <nav class="nav-links" aria-label="Primary">
        <a href="/#tools">Tools</a>
        <a href="/income-tax-tool/">Income Tax</a>
        <a href="/emi-calculator/">EMI</a>
        <a href="/gst-calculator/">GST</a>
        <a aria-current="page" href="/domain-finder/">Domains</a>
      </nav>
    </div>
  </header>

  <main class="page">
    <!-- LEFT: Three separate sections -->
    <section class="panel" id="controls">
      <div class="panel-header">
        <div class="panel-title"><span class="pill">DF</span> Domain Opportunities</div>
        <button class="btn sm secondary" id="resetBtn">Reset</button>
      </div>

      <div class="panel-body">
        <!-- 1) Seed word domain name finder -->
        <div class="section" id="seed-sec">
          <h4>1) Seed Keyword Finder</h4>
          <div class="row-grid">
            <label for="kw">Seed keywords (optional, comma/space separated)</label>
            <input id="kw" class="input" placeholder="e.g., ai, health, travel — or leave empty" />
          </div>
          <div class="row-grid row-2">
            <div>
              <label>TLDs</label>
              <div class="chips" id="tlds-seed">
                <button class="chip active" data-tld=".com" aria-pressed="true">.com</button>
                <button class="chip active" data-tld=".in" aria-pressed="true">.in</button>
                <button class="chip active" data-tld=".co" aria-pressed="true">.co</button>
                <button class="chip" data-tld=".ai" aria-pressed="false">.ai</button>
                <button class="chip" data-tld=".io" aria-pressed="false">.io</button>
                <button class="chip" data-tld=".dev" aria-pressed="false">.dev</button>
                <button class="chip" data-tld=".app" aria-pressed="false">.app</button>
              </div>
            </div>
            <div>
              <label for="maxLen">Max name length</label>
              <input id="maxLen" type="number" class="input" min="3" max="30" value="14" />
              <label for="allow">Characters</label>
              <select id="allow" class="input">
                <option value="no">No digits/hyphens</option>
                <option value="digits-ok">Digits OK</option>
                <option value="hyphen-ok">Hyphens OK</option>
                <option value="both-ok">Both OK</option>
              </select>
            </div>
          </div>
          <button class="btn primary" id="runSeedBtn">Find from Seeds</button>
        </div>

        <!-- 2) Length-based -->
        <div class="section" id="length-sec">
          <h4>2) Length-Based Generator</h4>
          <div class="row-grid row-3">
            <div>
              <label for="lenN">Target length</label>
              <input id="lenN" type="number" class="input" min="2" max="15" value="6" />
            </div>
            <div>
              <label for="lenKind">Generation</label>
              <select id="lenKind" class="input">
                <option value="pattern" selected>Pronounceable (C/V patterns)</option>
                <option value="perm">Permutations (short length)</option>
              </select>
            </div>
            <div>
              <label for="lenLimit">Max candidates</label>
              <input id="lenLimit" type="number" class="input" min="10" max="1000" value="200" />
            </div>
          </div>
          <div class="row-grid row-3">
            <div>
              <label>Allowed chars</label>
              <div class="chips" id="lenChars">
                <button class="chip active" data-flag="letters" aria-pressed="true">Letters a–z</button>
                <button class="chip" data-flag="digits" aria-pressed="false">Digits 0–9</button>
                <button class="chip" data-flag="hyphen" aria-pressed="false">Hyphen -</button>
              </div>
            </div>
            <div>
              <label>Start with</label>
              <div class="chips" id="lenStart">
                <button class="chip active" data-start="letter" aria-pressed="true">Letter</button>
                <button class="chip" data-start="any" aria-pressed="false">Any</button>
              </div>
            </div>
            <div>
              <label>TLDs</label>
              <div class="chips" id="tlds-length">
                <button class="chip active" data-tld=".com" aria-pressed="true">.com</button>
                <button class="chip active" data-tld=".in" aria-pressed="true">.in</button>
                <button class="chip" data-tld=".co" aria-pressed="false">.co</button>
                <button class="chip" data-tld=".io" aria-pressed="false">.io</button>
                <button class="chip" data-tld=".ai" aria-pressed="false">.ai</button>
              </div>
            </div>
          </div>
          <button class="btn primary" id="runLengthBtn">Generate by Length</button>
        </div>

        <!-- 3) Regex-based -->
        <div class="section" id="regex-sec">
          <h4>3) Regex-Based Filter</h4>
          <div class="row-grid">
            <label for="regexFilter">Regex pattern (match domain name or full domain)</label>
            <input id="regexFilter" class="input" placeholder="Raw: ^re[a-z]{3}$  or JS style: /^[a-z]{5}\d$/i" />
          </div>
          <div class="row-3">
            <div>
              <label>Scope</label>
              <div class="chips" id="regexScope">
                <button class="chip active" data-scope="name" aria-pressed="true">Name only</button>
                <button class="chip" data-scope="full" aria-pressed="false">Include TLD</button>
              </div>
            </div>
            <div>
              <label>Flags</label>
              <div class="chips" id="regexFlags">
                <button class="chip" data-flag="i" aria-pressed="false">Ignore case /i</button>
              </div>
            </div>
            <div>
              <label>&nbsp;</label>
              <div id="regexErr" class="tag" style="display:none;">Invalid regex pattern</div>
            </div>
          </div>
          <div class="row-grid row-2">
            <div>
              <label>TLDs (used when scope = name)</label>
              <div class="chips" id="tlds-regex">
                <button class="chip active" data-tld=".com" aria-pressed="true">.com</button>
                <button class="chip active" data-tld=".in" aria-pressed="true">.in</button>
                <button class="chip" data-tld=".co" aria-pressed="false">.co</button>
                <button class="chip" data-tld=".io" aria-pressed="false">.io</button>
                <button class="chip" data-tld=".ai" aria-pressed="false">.ai</button>
              </div>
            </div>
            <div>
              <label for="regexPool">Candidate pool size (generated to test)</label>
              <input id="regexPool" type="number" class="input" min="50" max="1200" value="400" />
            </div>
          </div>
          <div class="row-grid">
            <label>Example matches your regex would accept</label>
            <div class="examples" id="regexExamples"><span class="tag">Type a regex to preview examples…</span></div>
          </div>
          <button class="btn primary" id="runRegexBtn">Filter by Regex</button>
        </div>

        <!-- Global options -->
        <div class="row-grid row-2">
          <div>
            <label for="expWindow">Expiring within (days)</label>
            <input id="expWindow" class="input" type="number" min="1" max="120" value="30" />
          </div>
          <div>
            <label for="withTraffic">Traffic estimate</label>
            <select id="withTraffic" class="input">
              <option value="expiring" selected>Expiring only (recommended)</option>
              <option value="all">All domains (slower)</option>
              <option value="off">Off (fastest)</option>
            </select>
          </div>
        </div>

        <div class="kbar">
          <button class="btn" id="exportBtn">Export CSV</button>
        </div>

        <div class="kbar" aria-live="polite">
          <span id="statLabel">Idle</span>
          <div class="progress"><span id="statBar"></span></div>
        </div>

        <div class="card" style="padding:.7rem;">
          <div class="row-grid">
            <strong style="color:#e6f1ff;">Marketplaces & Tools</strong>
            <div class="chips">
              <a class="chip" href="https://auctions.godaddy.com/" target="_blank" rel="noopener">GoDaddy Auctions</a>
              <a class="chip" href="https://www.namejet.com/" target="_blank" rel="noopener">NameJet</a>
              <a class="chip" href="https://www.dropcatch.com/" target="_blank" rel="noopener">DropCatch</a>
              <a class="chip" href="https://www.expireddomains.net/" target="_blank" rel="noopener">ExpiredDomains</a>
              <a class="chip" href="https://lookup.icann.org/en/lookup" target="_blank" rel="noopener">ICANN WHOIS</a>
              <a class="chip" href="https://web.archive.org/" target="_blank" rel="noopener">Archive.org</a>
            </div>
            <p class="tag">We verify via <b>RDAP</b> and show <b>expiry dates</b> when registries expose them. Traffic is best-effort; if blocked you’ll see <b>N/A</b>.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- RIGHT: Results -->
    <section class="right">
      <article class="card">
        <h3>Available Now <span class="badge" id="countAvail">0</span></h3>
        <div class="rows" id="listAvail">
          <div class="tag">Run a search to see available domains.</div>
        </div>
      </article>

      <div class="lists">
        <article class="card">
          <h3>Expiring Soon <span class="badge" id="countExp">0</span></h3>
          <div class="rows" id="listExp">
            <div class="tag">Find domains expiring within your window.</div>
          </div>
        </article>

        <article class="card video-card" aria-labelledby="ytTitle">
          <h3 id="ytTitle">How to Flip Domains (Beginner to Pro)</h3>
          <div class="frame" id="ytFrame">
            <!-- Inline SVG placeholder to avoid 404 -->
            <button class="thumb" id="ytLoad" aria-label="Play tutorial video" data-id="dQw4w9WgXcQ">
              <img alt="Domain flipping tutorial"
                   width="560" height="315" loading="lazy" decoding="async"
                   src='data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="1280" height="720"><defs><linearGradient id="g" x1="0" x2="1" y1="0" y2="1"><stop stop-color="%230b1020" offset="0"/><stop stop-color="%2311223a" offset="1"/></linearGradient></defs><rect fill="url(%23g)" width="100%25" height="100%25"/><text x="50%25" y="50%25" fill="%23e6f1ff" font-family="system-ui,Segoe UI,Roboto" font-size="48" text-anchor="middle" dominant-baseline="middle">UpTools • Domain Flipping Tutorial</text></svg>'>
              <div class="play" aria-hidden="true"></div>
            </button>
          </div>
        </article>
      </div>
    </section>
  </main>

  <footer>
    © UpTools · <a href="/#tools">All Tools</a> · <a href="/currency-converter/">Currency</a> · <a href="/password-generator/">Passwords</a> · <a href="/uuid-generator/">UUID</a> · <a href="/whatsapp-chat/">WhatsApp Link</a>
  </footer>

  <script>
    /* ====== Fallback Utils (if /utils.js missing) ====== */
    const Utils = (window.Utils) || {
      $: (s, r=document)=>r.querySelector(s),
      $$: (s, r=document)=>[...r.querySelectorAll(s)],
      debounce(fn, d=160){ let t; return (...a)=>{ clearTimeout(t); t=setTimeout(()=>fn(...a), d); }; },
      fmtNum:(n,o={})=>(new Intl.NumberFormat('en-IN', {maximumFractionDigits:2, ...o}).format(n??0)),
      download(name, data, type="text/csv"){ const blob = new Blob([data], {type}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download=name; a.click(); URL.revokeObjectURL(a.href); }
    };
    const {$, $$} = Utils;

    /* ====== Chip toggles ====== */
    function initChipToggle(containerSelector, onToggle, singleSelect=false){
      $$(containerSelector + ' .chip').forEach(c=>{
        c.addEventListener('click', ()=>{
          if(singleSelect){
            $$(containerSelector + ' .chip').forEach(x=>{ x.classList.remove('active'); x.setAttribute('aria-pressed','false'); });
            c.classList.add('active'); c.setAttribute('aria-pressed','true');
          }else{
            c.classList.toggle('active');
            c.setAttribute('aria-pressed', c.classList.contains('active') ? 'true' : 'false');
          }
          onToggle?.(c, c.classList.contains('active'));
        });
      });
    }

    /* ====== TLD sets per section ====== */
    const tldSeed = new Set([".com",".in",".co"]);
    const tldLength = new Set([".com",".in"]);
    const tldRegex = new Set([".com",".in"]);
    initChipToggle('#tlds-seed',  (c,a)=>{ const t=c.dataset.tld; if(a) tldSeed.add(t); else tldSeed.delete(t); });
    initChipToggle('#tlds-length',(c,a)=>{ const t=c.dataset.tld; if(a) tldLength.add(t); else tldLength.delete(t); });
    initChipToggle('#tlds-regex', (c,a)=>{ const t=c.dataset.tld; if(a) tldRegex.add(t); else tldRegex.delete(t); });

    /* ====== Length flags ====== */
    const lenFlags = { letters:true, digits:false, hyphen:false, start:'letter' };
    initChipToggle('#lenChars', (c,a)=>{ lenFlags[c.dataset.flag] = a; });
    initChipToggle('#lenStart', (c,a)=>{
      if(a){
        $$('#lenStart .chip').forEach(x=>{ if(x!==c){ x.classList.remove('active'); x.setAttribute('aria-pressed','false'); } });
        lenFlags.start = c.dataset.start;
      }
    }, true);

    /* ====== Regex controls ====== */
    let regexScope = 'name';
    let regexFlags = '';
    initChipToggle('#regexScope', (c,a)=>{
      if(a){
        $$('#regexScope .chip').forEach(x=>{ if(x!==c){ x.classList.remove('active'); x.setAttribute('aria-pressed','false'); } });
        regexScope = c.dataset.scope || 'name';
        updateRegexExamples();
      }
    }, true);
    initChipToggle('#regexFlags', (c,a)=>{
      const f = c.dataset.flag;
      if(a && !regexFlags.includes(f)) regexFlags += f;
      if(!a) regexFlags = regexFlags.replace(new RegExp(f,'g'),'');
      updateRegexExamples();
    });

    function parseRegexInput(input, chipFlags){
      const s = input.trim();
      if(!s) return null;
      // Accept `/pattern/gi` or raw `pattern`
      if(s.startsWith('/')){
        const last = s.lastIndexOf('/');
        if(last > 0){
          const body = s.slice(1,last);
          const tail = s.slice(last+1);
          const merged = [...new Set((tail+chipFlags).split(''))].join('');
          try{ return new RegExp(body, merged); }catch(e){ return 'invalid'; }
        }
      }
      try{ return new RegExp(s, chipFlags); }catch(e){ return 'invalid'; }
    }

    function showRegexError(on=true){
      $('#regexErr').style.display = on ? 'inline-block' : 'none';
    }

    /* ====== Generators & helpers ====== */
    const vowels = new Set('aeiou');
    function brandScore(domain){
      const name = domain.split('.')[0];
      const len = name.length;
      const hasHyphen = /-/.test(name);
      const hasDigit = /\d/.test(name);
      const vc = name.replace(/[^a-z]/g,'').split('').map(c=> vowels.has(c)?'v':'c').join('');
      let s = 100;
      if(len < 4 || len > 14) s -= 20;
      if(hasHyphen) s -= 15;
      if(hasDigit) s -= 10;
      if(/(vv|ccc{3,}|[aeiou]{4,})/.test(vc)) s -= 10;
      if(/(ai|io|ly|ify|hub|labs|base|stack|gen|flow|grid|zone|nest|forge|kit|deck|nova|pulse|mint)$/.test(name)) s += 8;
      if(/^(go|get|try|my|hey|we|use|top|pro)/.test(name)) s += 5;
      return Math.max(0, Math.min(100, s));
    }
    const PREFIX = ["go","get","try","my","hey","we","use","top","pro","neo","ultra","swift","true","hyper","omni","mint","clear","alpha","next"];
    const SUFFIX = ["ly","ify","io","hub","labs","base","stack","gen","flow","grid","zone","spot","deck","kit","forge","nest","pilot","vista","pulse","mint"];
    function combos(seed){
      const out = new Set();
      const s = (seed||'').toLowerCase().replace(/[^a-z0-9-]+/g,'');
      if(!s) return out;
      out.add(s);
      PREFIX.forEach(p=> out.add(p+s));
      SUFFIX.forEach(x=> out.add(s+x));
      out.add(s.replace(/[aeiou][^aeiou]*$/,'')); // blend
      out.add(s.slice(0, Math.max(3, s.length-1)));
      return out;
    }
    function makeCandidates(words, tlds, maxLen, mode){
      const allowHyphen = /hyphen|both/.test(mode);
      const allowDigit  = /digits|both/.test(mode);
      const seeds = new Set();
      words.forEach(w=> combos(w).forEach(x=> seeds.add(x)));
      const out=[];
      seeds.forEach(n=>{
        tlds.forEach(tld=>{
          let name=n;
          if(!allowHyphen) name = name.replace(/-/g,'');
          if(!allowDigit)  name = name.replace(/\d/g,'');
          const d = `${name}${tld}`;
          if(name && d.length <= maxLen + tld.length && /^[a-z0-9-]+(\.[a-z]{2,})$/.test(d)){
            out.push(d);
          }
        });
      });
      const uniq = [...new Set(out)];
      return uniq.slice(0, 250).map(d=>({domain:d, score:brandScore(d)}))
                 .sort((a,b)=> b.score - a.score || a.domain.length - b.domain.length);
    }

    const letters = 'abcdefghijklmnopqrstuvwxyz';
    const digits  = '0123456789';
    const Cset = 'bcdfghjklmnpqrstvwxyz';
    const Vset = 'aeiou';

    function pickCharset(flags){
      let cs = flags.letters ? letters : '';
      if(flags.digits) cs += digits;
      if(flags.hyphen) cs += '-';
      return cs;
    }
    function sanitizeName(name, flags){
      if(!flags.hyphen) name = name.replace(/-+/g,'');
      else name = name.replace(/^-+/, '').replace(/-+$/, '').replace(/--+/g, '-');
      if(flags.start==='letter') name = name.replace(/^[^a-z]+/,'');
      return name;
    }
    function bruteForceByLength(n, flags, limit){
      const cs = pickCharset(flags); if(!cs) return [];
      const N = cs.length ** n, CAP = 15000;
      const results = new Set();
      if(N <= CAP){
        const idx = Array(n).fill(0);
        while(true){
          let s=''; for(let i=0;i<n;i++) s += cs[idx[i]];
          s = sanitizeName(s, flags); if(s.length===n) results.add(s);
          let p=n-1; while(p>=0 && ++idx[p]===cs.length){ idx[p]=0; p--; }
          if(p<0) break; if(results.size >= limit) break;
        }
      }else{
        let tries=0;
        while(results.size < limit && tries < limit*20){
          let s=''; for(let i=0;i<n;i++) s += cs[Math.floor(Math.random()*cs.length)];
          s = sanitizeName(s, flags); if(s.length===n) results.add(s); tries++;
        }
      }
      return [...results];
    }
    function buildPatterns(n){
      const base=['cv','cvc','cvv','vcv','cvcv','cvvc','vcvc','cvcvc','cvccv','cvcvv','cvvcv','vcvcv','cvcvcv'];
      const filtered = base.filter(p=> p.length===n);
      if(filtered.length) return filtered;
      const out=[]; let s='cvcv'; while(s.length<n){ s+='cv'; } out.push(s.slice(0,n));
      s='cvvcvvcvvcvv'; while(s.length<n){ s+='cv'; } out.push(s.slice(0,n));
      out.push('c'.repeat(n).replace(/cc/g,'cv'));
      return [...new Set(out)];
    }
    function patternCandidates(n, flags, limit){
      const out=new Set(), patterns=buildPatterns(n); let tries=0;
      while(out.size<limit && tries<limit*50){
        const pat=patterns[Math.floor(Math.random()*patterns.length)];
        let s=''; for(const ch of pat){ s += ch==='c' ? Cset[Math.floor(Math.random()*Cset.length)] : Vset[Math.floor(Math.random()*Vset.length)]; }
        if(flags.digits && Math.random()<0.15){ const pos=1+Math.floor(Math.random()*(s.length-2)); s=s.slice(0,pos)+digits[Math.floor(Math.random()*digits.length)]+s.slice(pos+1); }
        if(flags.hyphen && Math.random()<0.1){ const pos=2+Math.floor(Math.random()*(s.length-3)); s=s.slice(0,pos)+'-'+s.slice(pos); }
        s=sanitizeName(s,flags); if(flags.start==='letter' && !/^[a-z]/.test(s)){ tries++; continue; }
        if(s.length===n) out.add(s); tries++;
      }
      return [...out];
    }
    function makeLengthDomains(n, flags, kind, tlds, limit){
      const names = kind==='perm' ? bruteForceByLength(n, flags, limit) : patternCandidates(n, flags, limit);
      const domains=[]; names.forEach(name=>{ tlds.forEach(tld=>{ const d=`${name}${tld}`; if(/^[a-z0-9-]+(\.[a-z]{2,})$/.test(d)) domains.push(d); }); });
      const uniq=[...new Set(domains)];
      return uniq.map(d=>({domain:d, score:brandScore(d)}))
                 .sort((a,b)=> b.score - a.score || a.domain.length - b.domain.length)
                 .slice(0, limit);
    }

    /* ====== RDAP / Traffic ====== */
    async function rdapLookup(domain){
      const url = `/api?url=${encodeURIComponent('https://rdap.org/domain/' + domain)}`;
      try{
        const res = await fetch(url, {cache:'no-store'});
        if(res.status === 404) return { status:'available' };
        if(!res.ok) return { status:'unknown' };
        const j = await res.json();
        const events = Array.isArray(j.events)? j.events : [];
        const expEvt = events.find(e=> /(expir|expire)/i.test(e.eventAction || ''));
        const exp = expEvt?.eventDate || null;
        let registrar = j.registrarName || '';
        if(!registrar && Array.isArray(j.entities)){
          for(const ent of j.entities){
            if((ent.roles||[]).includes('registrar') && Array.isArray(ent.vcardArray)){
              const card = ent.vcardArray[1] || [];
              const fn = card.find(row => row[0]==='fn');
              if(fn && fn[3]) registrar = fn[3];
            }
          }
        }
        return { status:'registered', expiration: exp, registrar };
      }catch(_e){ return { status:'error' }; }
    }
    async function trafficEstimate(domain){
      const sw = `/api?url=${encodeURIComponent('https://data.similarweb.com/api/v1/data?domain=' + domain)}`;
      try{
        const r = await fetch(sw, {cache:'no-store'});
        if(!r.ok) return { rank:null, visits:null };
        const j = await r.json();
        const rank = j?.GlobalRank?.Rank ?? null;
        const visits = j?.Engagements?.Visits ?? null;
        return { rank, visits };
      }catch(_e){ return { rank:null, visits:null }; }
    }
    async function mapLimit(items, limit, worker){
      const ret=[]; let i=0;
      const runners = Array(Math.min(limit, items.length)).fill(0).map(async function run(){
        while(i<items.length){ const cur=i++; ret[cur] = await worker(items[cur], cur); }
      });
      await Promise.all(runners); return ret;
    }

    /* ====== Rendering & progress ====== */
    const listAvail = $('#listAvail');
    const listExp   = $('#listExp');
    const countAvail = $('#countAvail');
    const countExp = $('#countExp');

    function rowHtml({domain, score, when, rank, visits, registrar}){
      const buy = [
        ["Namecheap", `https://www.namecheap.com/domains/registration/results/?domain=${encodeURIComponent(domain)}`],
        ["Porkbun", `https://porkbun.com/search?q=${encodeURIComponent(domain)}`],
        ["Dynadot", `https://www.dynadot.com/domain/search.html?domain=${encodeURIComponent(domain)}`],
        ["GoDaddy", `https://in.godaddy.com/domainsearch/find?domainToCheck=${encodeURIComponent(domain)}`]
      ];
      const links = buy.map(([t,h])=>`<a class="btn sm ghost" href="${h}" target="_blank" rel="noopener" title="Open ${t} in new tab">${t}</a>`).join('');
      const trafficText = (rank || visits) ? `
        ${rank ? `<span class="tag">Rank <span class="rank">#${Utils.fmtNum(rank,{maximumFractionDigits:0})}</span></span>`:''}
        ${visits ? `<span class="tag">Visits <span class="visits">${Utils.fmtNum(visits,{maximumFractionDigits:0})}</span></span>`:''}
      ` : `<span class="tag" title="Traffic source unavailable or blocked; try later or keep Off for speed.">Traffic: N/A</span>`;
      const expiryText = when ? `<span class="tag">Expiry <span class="when">${when}</span></span>` : '';
      const regText = registrar ? `<span class="tag" title="Registrar">${registrar}</span>` : '';
      return `<div class="rowi">
        <div>
          <div class="n">${domain}</div>
          <div class="meta">
            <span class="tag">Score <span class="score">${score}</span></span>
            ${expiryText}
            ${trafficText}
            ${regText}
          </div>
        </div>
        <div class="act">${links}</div>
      </div>`;
    }
    function addAvail(item){
      if(listAvail.querySelector('.tag') && listAvail.children.length===1) listAvail.innerHTML='';
      listAvail.insertAdjacentHTML('beforeend', rowHtml(item));
      countAvail.textContent = String(+countAvail.textContent + 1);
    }
    function addExp(item){
      if(listExp.querySelector('.tag') && listExp.children.length===1) listExp.innerHTML='';
      listExp.insertAdjacentHTML('beforeend', rowHtml(item));
      countExp.textContent = String(+countExp.textContent + 1);
    }
    function setProgress(done, total, label='Working…'){
      $('#statLabel').textContent = `${label} ${done}/${total}`;
      $('#statBar').style.width = total ? `${Math.round(done*100/total)}%` : '0%';
    }

    function resetResults(msgA='Run a search to see available domains.', msgE='Find domains expiring within your window.'){
      listAvail.innerHTML = `<div class="tag">${msgA}</div>`;
      listExp.innerHTML   = `<div class="tag">${msgE}</div>`;
      countAvail.textContent='0'; countExp.textContent='0';
    }

    /* ====== Core runner (shared) ====== */
    async function runCheck(domains, label){
      resetResults('Checking…','Checking…');
      setProgress(0,0,label);

      domains = [...new Set(domains)].slice(0, 400);
      if(domains.length===0){ resetResults('No candidates with current settings.','No candidates with current settings.'); setProgress(0,0,'Idle'); return; }

      const total = domains.length; let done=0; setProgress(done,total,`${label} (RDAP)`);
      const expWindowDays = Math.max(1, Math.min(120, +$('#expWindow').value || 30));
      const trafficMode = $('#withTraffic').value; // expiring | all | off
      const wantTrafficAll = trafficMode === 'all';
      const wantTrafficExp = trafficMode === 'expiring';
      const scoreMap = new Map(domains.map(d => [d, brandScore(d)]));

      await mapLimit(domains, 6, async (domain)=>{
        const rd = await rdapLookup(domain);
        let rank=null, visits=null;
        if(rd.status === 'available'){
          if(wantTrafficAll){ ({rank, visits} = await trafficEstimate(domain)); }
          addAvail({ domain, score: scoreMap.get(domain), rank, visits });
        }else if(rd.status === 'registered' && rd.expiration){
          const exp = new Date(rd.expiration);
          if(!isNaN(exp)){
            const today = new Date();
            const days = Math.floor((exp - today)/86400000);
            if(days >= 0 && days <= expWindowDays){
              if(wantTrafficAll || wantTrafficExp){ ({rank, visits} = await trafficEstimate(domain)); }
              const when = exp.toISOString().split('T')[0];
              addExp({ domain, score: scoreMap.get(domain), when, rank, visits, registrar: rd.registrar || '' });
            }
          }
        }
        done++; setProgress(done,total,`${label} (RDAP)`);
      });

      if(+countAvail.textContent === 0) listAvail.innerHTML = '<div class="tag">No immediately available domains found.</div>';
      if(+countExp.textContent === 0) listExp.innerHTML = '<div class="tag">No domains expiring within your chosen window.</div>';
    }

    /* ====== Buttons ====== */
    $('#resetBtn').addEventListener('click', ()=>{
      resetResults();
      setProgress(0,0,'Idle');
      $('#kw').value='';
      $('#regexFilter').value='';
      showRegexError(false);
      $('#regexExamples').innerHTML = '<span class="tag">Type a regex to preview examples…</span>';
    });

    // Seed run
    $('#runSeedBtn').addEventListener('click', ()=>{
      const raw = $('#kw').value.trim();
      const words = raw ? raw.split(/[,\s]+/).map(s=>s.trim()).filter(Boolean).slice(0,8) : [];
      const maxLen = +$('#maxLen').value || 14;
      const allow = $('#allow').value;
      const tlds = [...tldSeed];
      let domains;
      if(words.length){
        domains = makeCandidates(words, tlds, maxLen, allow).map(x=>x.domain);
      }else{
        // fallback to pronounceable length-based using maxLen
        const n = Math.min(12, Math.max(3, Math.floor(maxLen/1.2)));
        const flags = { letters:true, digits:/digits|both/.test(allow), hyphen:/hyphen|both/.test(allow), start:'letter' };
        domains = makeLengthDomains(n, flags, 'pattern', tlds, 200).map(x=>x.domain);
      }
      runCheck(domains, 'Seed Finder');
    });

    // Length run
    $('#runLengthBtn').addEventListener('click', ()=>{
      const n = Math.max(2, Math.min(15, +$('#lenN').value || 6));
      const kind = $('#lenKind').value;
      const limit = Math.max(10, Math.min(1000, +$('#lenLimit').value || 200));
      const tlds = [...tldLength];
      const domains = makeLengthDomains(n, lenFlags, kind, tlds, limit).map(x=>x.domain);
      runCheck(domains, 'Length Generator');
    });

    /* ====== Regex Examples + Run ====== */
    function genCandidateNames(pool=400){
      // mix pronounceable 4–9 length + a few randoms
      const t = Math.max(50, Math.min(1200, pool));
      const out = new Set();
      const lens = [4,5,6,7,8,9];
      while(out.size < t){
        const n = lens[Math.floor(Math.random()*lens.length)];
        const names = patternCandidates(n, {letters:true,digits:Math.random()<.25,hyphen:Math.random()<.15,start:'letter'}, 1+Math.floor(Math.random()*3));
        names.forEach(x=> out.add(x));
        if(Math.random()<0.2 && out.size < t){ // sprinkle some randoms
          let s=''; const cs = letters + (Math.random()<.3?digits:'');
          const L = 3+Math.floor(Math.random()*8);
          for(let i=0;i<L;i++) s += cs[Math.floor(Math.random()*cs.length)];
          out.add(s);
        }
      }
      return [...out].slice(0,t);
    }

    function updateRegexExamples(){
      const patt = $('#regexFilter').value;
      const re = parseRegexInput(patt, regexFlags);
      const box = $('#regexExamples');
      showRegexError(re==='invalid');
      if(re==='invalid'){ box.innerHTML = '<span class="tag">Invalid regex. Fix and we will preview examples.</span>'; return; }
      if(!re){ box.innerHTML = '<span class="tag">Type a regex to preview examples…</span>'; return; }

      const names = genCandidateNames(Math.max(80, Math.min(400, +$('#regexPool').value || 400)));
      const tlds = [...tldRegex];
      const matches = [];
      for(const name of names){
        const target = (regexScope==='full') ? `${name}${tlds[Math.floor(Math.random()*tlds.length)]}` : name;
        if(re.test(target)) matches.push(target);
        if(matches.length >= 12) break;
      }
      if(matches.length===0){
        box.innerHTML = '<span class="tag">No quick examples matched. Try relaxing the pattern.</span>';
      }else{
        box.innerHTML = matches.map(m=>`<span class="ex">${m}</span>`).join('');
      }
    }
    $('#regexFilter').addEventListener('input', Utils.debounce(updateRegexExamples, 200));
    $('#regexPool').addEventListener('input', Utils.debounce(updateRegexExamples, 300));
    // Update examples if TLDs change and scope is full/name relevant
    ['#tlds-regex','#regexScope','#regexFlags'].forEach(sel=>{
      $$(sel + ' .chip').forEach(ch=> ch.addEventListener('click', Utils.debounce(updateRegexExamples, 150)));
    });

    $('#runRegexBtn').addEventListener('click', ()=>{
      const patt = $('#regexFilter').value;
      const re = parseRegexInput(patt, regexFlags);
      if(re==='invalid'){ showRegexError(true); return; }
      showRegexError(false);

      // Build a large candidate pool and filter by regex
      const pool = genCandidateNames(Math.max(200, Math.min(1200, +$('#regexPool').value || 400)));
      const tlds = [...tldRegex];
      let domains = [];
      if(regexScope === 'full'){
        domains = pool.map(n => `${n}${tlds[Math.floor(Math.random()*tlds.length)]}`).filter(d => re.test(d));
      }else{
        // name-only: test name; then attach all selected TLDs
        const names = pool.filter(n => re.test(n));
        names.forEach(n => tlds.forEach(t => domains.push(`${n}${t}`)));
      }
      runCheck(domains, 'Regex Filter');
    });

    /* ====== Export & Reset ====== */
    function exportCSV(){
      const rows = [['domain','score','status','expiry','rank','visits','registrar']];
      $$('#listAvail .rowi, #listExp .rowi').forEach(r=>{
        const domain = r.querySelector('.n')?.textContent?.trim() || '';
        const score = r.querySelector('.score')?.textContent?.trim() || '';
        const when  = r.querySelector('.when')?.textContent?.trim() || '';
        const rank  = r.querySelector('.rank')?.textContent?.replace('#','').trim() || '';
        const visits= r.querySelector('.visits')?.textContent?.trim() || '';
        const status = r.closest('#listExp') ? 'expiring' : 'available';
        const regTag = [...r.querySelectorAll('.meta .tag')].find(t=> t.title==='Registrar');
        const registrar = regTag ? regTag.textContent.trim() : '';
        rows.push([domain, score, status, when, rank, visits, registrar]);
      });
      const csv = rows.map(r=> r.map(x=> `"${String(x).replace(/"/g,'""')}"`).join(',')).join('\n');
      Utils.download('domain_opportunities.csv', csv, 'text/csv');
    }
    $('#exportBtn').addEventListener('click', exportCSV);

    /* ====== Video Lazy Loader ====== */
    $('#ytLoad').addEventListener('click', ()=>{
      const id = $('#ytLoad').dataset.id;
      const ifr = document.createElement('iframe');
      ifr.width=560; ifr.height=315;
      ifr.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share";
      ifr.referrerPolicy="strict-origin-when-cross-origin";
      ifr.allowFullscreen = true;
      ifr.src = `https://www.youtube-nocookie.com/embed/${encodeURIComponent(id)}?autoplay=1&rel=0`;
      const frame = $('#ytFrame'); frame.innerHTML=''; frame.appendChild(ifr);
    });
  </script>
</body>
</html>
