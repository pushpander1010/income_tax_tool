<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Common site styles -->
  <link rel="stylesheet" href="/style.css?v=1.3.0" />

  <!-- Ads (optional; keep to avoid CLS issues) -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6216304334889617" crossorigin="anonymous"></script>

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>AI Plagiarism Checker — UpTools</title>
  <meta name="description" content="Paste text and check similarity with mobile-perfect layout. Uses common styles across UpTools." />
  <link rel="canonical" href="https://www.uptools.in/ai-plagiarism/" />
  <meta name="robots" content="index,follow,max-snippet:-1,max-image-preview:large,max-video-preview:large" />
  <meta name="theme-color" content="#0f1419" />

  <!-- Tiny inline CSS only for behavior that may not exist in your global sheet -->
  <style>
    /* make grid stack on mobile, 2-cols on md if your sheet lacks a helper */
    .plag-grid{display:grid; gap:12px}
    @media (min-width:768px){ .plag-grid{grid-template-columns:1fr 1fr} }

    /* ensure flex/grid children can shrink; prevent overlap */
    .min0{min-width:0; min-height:0}

    /* safe wrapping for long URLs/snippets */
    .wrap{overflow-wrap:anywhere; word-break:break-word}

    /* simple inline loader (non-overlay, non-absolute) */
    .loader{display:inline-flex; align-items:center; gap:8px}
    .dot{width:8px; height:8px; border-radius:50%; background:currentColor; opacity:.3; animation:bounce 1s infinite}
    .dot:nth-child(2){animation-delay:.15s}
    .dot:nth-child(3){animation-delay:.3s}
    @keyframes bounce{0%,80%,100%{transform:scale(.8); opacity:.3} 40%{transform:scale(1); opacity:1}}

    /* results spacing if your .stack or .gap utilities differ */
    .results{display:grid; gap:12px}
  </style>
</head>
<body>
  <div class="page container pad-12" style="min-height:100dvh; display:grid; grid-template-rows:auto 1fr auto;">
    <header class="pad-b-8">
      <h1 class="h3 m-0">AI Plagiarism Checker</h1>
      <p class="text-muted small m-t-4">Uses shared components & spacing from your global stylesheet.</p>
    </header>

    <main class="min0">
      <section class="plag-grid">
        <!-- LEFT: INPUT -->
        <article class="card radius-16 shadow-xs border min0">
          <h2 class="h5 m-b-8">Paste Text</h2>

          <label for="textInput" class="small text-muted">Your text</label>
          <textarea id="textInput" class="input textarea m-t-6" placeholder="Paste or type your text here..." style="min-height:140px"></textarea>

          <div class="row m-t-8" style="display:flex; flex-wrap:wrap; gap:8px; align-items:center">
            <button id="checkBtn" class="btn btn-primary">Check Plagiarism</button>
            <button id="sampleBtn" class="btn btn-secondary">Use Sample</button>
            <button id="clearBtn" class="btn btn-ghost">Clear</button>

            <span id="status" class="small text-muted" aria-live="polite"></span>
          </div>

          <div class="row m-t-8" style="display:flex; flex-wrap:wrap; gap:8px; align-items:center">
            <span id="readyChip" class="chip">Ready</span>
            <span class="small text-muted">Engine:</span>
            <select id="engineSelect" class="select">
              <option value="fake" selected>Built-in Demo</option>
              <option value="api">My Backend (/ai)</option>
            </select>
          </div>

          <details class="m-t-8">
            <summary class="small"><strong>Backend wiring (optional)</strong></summary>
            <pre class="code wrap m-t-6" style="padding:10px; border:1px solid var(--line,#e5e7eb); border-radius:12px; background:#fafafa; white-space:pre-wrap">
POST /ai
{
  "provider": "google|groq|perplexity",
  "model": "your-model",
  "task": "plagiarism_check",
  "text": "…"
}
Response:
{
  "score": 0-100,
  "verdict": "Low|Medium|High similarity",
  "sources": [{ "title": "...", "url": "...", "match": "..." }]
}</pre>
          </details>
        </article>

        <!-- RIGHT: RESULTS -->
        <article class="card radius-16 shadow-xs border min0">
          <h2 class="h5 m-b-8">Results</h2>

          <div id="results" class="results" aria-live="polite" aria-busy="false">
            <div class="text-muted">Run a check to see similarity and sources here.</div>
          </div>

          <div class="row m-t-8" style="display:flex; flex-wrap:wrap; gap:8px; align-items:center">
            <button id="copyBtn" class="btn btn-secondary">Copy Summary</button>
            <button id="exportBtn" class="btn btn-ghost">Export JSON</button>
            <span id="helperMsg" class="small text-muted" style="margin-left:auto" aria-live="polite"></span>
          </div>
        </article>
      </section>
    </main>

    <footer class="small text-muted pad-t-8">
      Built with shared styles. No fixed heights, no absolute overlays, safe wrapping for long URLs/snippets.
    </footer>
  </div>

  <script type="module">
    // ---------- Helpers ----------
    const $ = (s)=>document.querySelector(s);
    const el = {
      text: $('#textInput'),
      check: $('#checkBtn'),
      sample: $('#sampleBtn'),
      clear: $('#clearBtn'),
      results: $('#results'),
      readyChip: $('#readyChip'),
      status: $('#status'),
      engine: $('#engineSelect'),
      copy: $('#copyBtn'),
      export: $('#exportBtn'),
      helper: $('#helperMsg'),
    };

    function setBusy(b){
      el.results?.setAttribute('aria-busy', String(b));
      el.status.textContent = b ? 'Checking…' : '';
    }

    function loader(){
      const wrap = document.createElement('div');
      wrap.className = 'loader text-muted';
      wrap.innerHTML = '<span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="small">Analyzing…</span>';
      return wrap;
    }

    const clamp = (n,min,max)=>Math.max(min,Math.min(max,n));

    // Local demo engine
    function fakeCheck(text){
      const len = text.trim().length;
      const words = (text.trim().match(/\S+/g)||[]).length;
      const pct = clamp(Math.round((len % 73) + (words % 27)), 0, 100);
      const verdict = pct>70 ? 'High similarity' : pct>35 ? 'Medium similarity' : 'Low similarity';
      const snip = text.substring(0, 160).replace(/\s+/g,' ').trim();
      return {
        score: pct,
        verdict,
        summary: 'Similarity analysis completed.',
        sources: [
          { title:'Open Web Snippet', url:'#', match: snip ? `“…${snip}…”` : 'Matched phrase' },
          { title:'Generic Knowledge Base', url:'#', match:'“…example paraphrase…”' }
        ]
      };
    }

    // Backend engine (/ai — same proxy you used for AI Writer)
    async function apiCheck(text){
      const payload = {
        provider: 'google',
        model: 'gemini-2.5-flash',
        task: 'plagiarism_check',
        text
      };
      const res = await fetch('/ai', {
        method: 'POST',
        headers: { 'content-type': 'application/json' },
        body: JSON.stringify(payload)
      });
      if(!res.ok){
        const msg = await res.text().catch(()=>res.statusText);
        throw new Error(`API error ${res.status}: ${msg}`);
      }
      return res.json();
    }

    function renderResult(r){
      const card = document.createElement('article');
      card.className = 'card radius-16 border shadow-xs min0';
      const scoreChip = `<span class="chip strong">Similarity: ${Math.round(r.score)}%</span>`;
      const verdict = `<span class="text-muted">${r.verdict || ''}</span>`;
      const sources = (Array.isArray(r.sources) ? r.sources : []).map(s => `
        <div class="card border radius-12 m-t-8">
          <div class="strong">${s.title || 'Source'}</div>
          <div class="small text-muted wrap">${s.url ? `<a href="${s.url}" rel="nofollow noopener">${s.url}</a>` : ''}</div>
          <div class="wrap code m-t-6" style="padding:10px; border:1px solid var(--line,#e5e7eb); border-radius:10px; background:#fafafa">${(s.match||'').toString()}</div>
        </div>
      `).join('');

      card.innerHTML = `
        <div class="row" style="display:flex; flex-wrap:wrap; gap:8px; align-items:center">
          ${scoreChip}
          ${verdict}
        </div>
        <div class="wrap code m-t-8" style="padding:10px; border:1px solid var(--line,#e5e7eb); border-radius:12px; background:#fafafa">
          <strong>Summary:</strong> ${r.summary || '—'}
        </div>
        <div class="results m-t-8">
          ${sources || '<div class="text-muted">No sources returned.</div>'}
        </div>
      `;
      return card;
    }

    function domToSummary(){
      const card = el.results.querySelector('.card');
      if(!card) return null;
      const score = card.querySelector('.chip')?.textContent || '';
      const verdict = card.querySelector('.row .text-muted')?.textContent || '';
      const srcs = Array.from(card.querySelectorAll('.results .card')).map((n,i)=>{
        const title = n.querySelector('.strong')?.textContent?.trim() || `Source ${i+1}`;
        const url = n.querySelector('a')?.getAttribute('href') || '';
        return `${i+1}. ${title}${url?` — ${url}`:''}`;
      }).join('\n');
      return `${score}\n${verdict}\nSources:\n${srcs || 'None'}`;
    }

    function domToJSON(){
      const card = el.results.querySelector('.card');
      if(!card) return null;
      const score = Number((card.querySelector('.chip')?.textContent.match(/\d+/)||[])[0]||0);
      const verdict = card.querySelector('.row .text-muted')?.textContent?.trim() || '';
      const sources = Array.from(card.querySelectorAll('.results .card')).map(n=>({
        title: n.querySelector('.strong')?.textContent?.trim() || 'Source',
        url: n.querySelector('a')?.getAttribute('href') || '',
        match: n.querySelector('.wrap.code')?.textContent?.trim() || ''
      }));
      return { score, verdict, sources };
    }

    // ---------- Events ----------
    $('#sampleBtn')?.addEventListener('click', ()=>{
      el.text.value =
`Artificial intelligence is rapidly transforming industries by automating routine tasks and enabling more accurate decision-making. From healthcare to agriculture, AI-driven solutions are improving efficiency, reducing costs, and unlocking new possibilities for innovation. However, this growth raises questions about ethics and the impact on jobs.`;
      el.text.focus();
      el.helper.textContent = 'Sample inserted.';
    });

    $('#clearBtn')?.addEventListener('click', ()=>{
      el.text.value = '';
      el.results.innerHTML = '<div class="text-muted">Cleared. Paste text and run a new check.</div>';
      el.helper.textContent = 'Input cleared.';
    });

    $('#checkBtn')?.addEventListener('click', async ()=>{
      const text = el.text.value || '';
      if(!text.trim()){ alert('Please paste some text first.'); return; }

      el.results.innerHTML = '';
      el.results.appendChild(loader());
      el.readyChip.textContent = 'Working…';
      setBusy(true);

      try{
        const engine = el.engine.value;
        const data = engine === 'api' ? await apiCheck(text) : fakeCheck(text);
        el.results.innerHTML = '';
        el.results.appendChild(renderResult(data));
        el.helper.textContent = 'Done.';
        el.readyChip.textContent = 'Done';
      }catch(err){
        el.results.innerHTML = `<div class="code wrap" style="padding:10px; border:1px solid var(--line,#e5e7eb); border-radius:12px; background:#fff3f3">Error: ${(err && err.message) || err}</div>`;
        el.helper.textContent = 'Failed.';
        el.readyChip.textContent = 'Error';
      }finally{
        setBusy(false);
      }
    });

    $('#copyBtn')?.addEventListener('click', async ()=>{
      const txt = domToSummary();
      if(!txt){ el.helper.textContent='Nothing to copy yet.'; return; }
      await navigator.clipboard.writeText(txt).catch(()=>{});
      el.helper.textContent = 'Summary copied.';
    });

    $('#exportBtn')?.addEventListener('click', ()=>{
      const obj = domToJSON();
      if(!obj){ el.helper.textContent='Nothing to export.'; return; }
      const blob = new Blob([JSON.stringify(obj,null,2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'plagiarism-result.json';
      document.body.appendChild(a); a.click(); a.remove();
      URL.revokeObjectURL(url);
      el.helper.textContent = 'Exported JSON.';
    });

    // a11y nicety: announce char count (non-overlay)
    let t;
    el.text?.addEventListener('input', ()=>{
      clearTimeout(t);
      t = setTimeout(()=>{ el.status.textContent = `Characters: ${el.text.value.length}`; }, 120);
    });
  </script>
</body>
</html>
